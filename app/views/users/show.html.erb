<%= javascript_include_tag 'home_page' %>
<script type="text/javascript" charset="utf-8">
  var storiesArray = <%=raw @stories_for_js%>
</script>

<div class="story-box">
 <h2>Start a new story.</h2>
 <br>
 <!--genre form commented out below, if it's needed -->
<!-- <%= render "new_genre_story_form", genre: @genre %> -->
  <%= render 'new_story_form', story: @story %>
</div>

<div class="other-stories-box">
   <h2> Add to a different story. </h2>
    <%if !@all_stories.nil?%>
      <%if !@all_stories.empty? %>
        <%= render "all_stories", :story => @all_stories.sample %>
      <%else%>
        <h3>None, yet!</h3>
        <% end %>
    <% end %>
</div>


<div class="your-stories-box">
  <h2>Your Stories</h2>
  <div class="your-stories-content">
    <%if @user_stories.empty?%>
      <h3>None, yet!</h3>
    <% else %>
      <%=render 'your_stories', :story => @user_stories.sample %>
      <br><button type="button" id="view-all-button">View All Stories</button>
      <div class="dese-stories">
        <h3 id='zzz'></h3>
      </div>
      <!-- <%=render :collection => @user_stories.reverse, :partial => "your_stories", :as => :story %> -->
    <% end %>
  </div>
</div>

<div class="your-contributions-box">
<h2>Your Contributions</h2>
  <% if @user_contributions.size < 1 %>
      <p> None, yet! </p>
 <% else %>
    <%= render 'your_contributions', :sentence => @user_contributions.sample %>
 <% end %>
</div>

<!-- JS FOR APPENDING ALL STORIES -->

<%=javascript_tag do %>
  var user = <%= @user.id %>
  <% end %>

<script type="text/javascript">
$(function() {
  var open = false;
  $('#view-all-button').on('click', function() {
    if (open == false) {
    $.get('/users/' + user + '/stories.json', function(data) {
      for (var i=0;i<data.length;i++) {
      $('#zzz').append(data[i].full_story + '<br>' + "<a href='/stories/" + data[i].id + "'>details</a>" + "&nbsp;&nbsp;|&nbsp;&nbsp<a href='/stories/" + data[i].id + "' data-method='delete' data-confirm='Are you sure you want to delete this?'>delete</a> " + '<br><br>');



    };
  });
    open = true;
  } else if (open == true) {
      $('#zzz').html('');
      open = false;
    }
  });
});
</script>
